function iframeStyle(e){e.id="iframe-wowsbar",e.setAttribute("allowTransparency","true"),e.style.height="0px",e.style.width="100%",e.style.display="block",e.style.backgroundColor="transparent",e.style.border="none",e.style.isolation="isolate",e.style.position="relative",e.style.zIndex=9999,e.style.transition="all 0.2s ease-in-out",e.frameBorder="0"}function setInnerHTML(e,o){e.innerHTML=o,Array.from(e.querySelectorAll("script")).forEach((e=>{const o=document.createElement("script");Array.from(e.attributes).forEach((e=>{o.setAttribute(e.name,e.value)}));const t=document.createTextNode(e.innerHTML);o.appendChild(t),e.parentNode.replaceChild(o,e)}))}async function fetchAnnouncementData(){const e=new URL(document.currentScript.src),o=e.searchParams.get("ulid"),t=e.searchParams.get("json");console.log("ulid:",o,"jsonUrl:",t);let n=window.location.hostname;const r=window.location.pathname;console.log("domain:",n,"path:",r),n.startsWith("www.")&&(n=n.slice(4));try{console.log("> On try");const e=await fetch(`ar_web_wowsbar_announcement.php?url_KHj321Tu=${t}?domain=${n}`,{headers:{Accept:"application/json","Content-Type":"application/json"}}).then((async e=>{console.log("> On response",e);const o=await e.json();if(console.log("ar_web_wowsbar:",o),!e.ok)throw new Error("Network response was not ok ---- "+e.statusText);return o}));console.log("======== new Announctment data",e);const o=document.querySelector("#wowsbar_announcement");o.style.height=e.container_properties.dimension.height.value+e.container_properties.dimension.height.unit,setInnerHTML(o,e.compiled_layout);const r=propertiesToHTMLStyle(e.container_properties);console.log("Container style:",r);for(const[e,t]of Object.entries(r))o.style[e]=t;const i=document.createElement("iframe");if(iframeStyle(i),e?.container_properties){const o=propertiesToHTMLStyle(e.container_properties);console.log("Container style:",o);for(const[e,t]of Object.entries(o))i.style[e]=t;window.addEventListener("message",(function(e){console.log("received message",e.data),"close_button_click"===e.data&&(console.log("Close button clicked"),i.style.top=`-${parseInt(o.height,10)+parseInt(o.height,10)}px`)}))}else console.error("No container properties found");const a=document.body;a.insertBefore(i,a.firstChild)}catch(e){console.error("Someting went wrong:",e)}}function propertiesToHTMLStyle(e,o){const t={position:e.position?.type||"static",left:e.isCenterHorizontal&&"fixed"===e.position?.type?"50%":e.position?.x||"0px",top:e.position?.y||"0px",transform:e.isCenterHorizontal&&"fixed"===e.position?.type?"translateX(-50%)":"",height:(e?.dimension?.height?.value||0)+e?.dimension?.height?.unit||"px",width:(e?.dimension?.width?.value||0)+e?.dimension?.width?.unit||"px",color:e?.text?.color,fontFamily:e?.text?.fontFamily,paddingTop:(e?.padding?.top?.value||0)+e?.padding?.unit,paddingBottom:(e?.padding?.bottom?.value||0)+e?.padding?.unit,paddingRight:(e?.padding?.right?.value||0)+e?.padding?.unit,paddingLeft:(e?.padding?.left?.value||0)+e?.padding?.unit,marginTop:(e?.margin?.top?.value||0)+e?.margin?.unit,marginBottom:(e?.margin?.bottom?.value||0)+e?.margin?.unit,marginRight:e.isCenterHorizontal?"auto":(e?.margin?.right?.value||0)+e?.margin?.unit,marginLeft:e.isCenterHorizontal?"auto":(e?.margin?.left?.value||0)+e?.margin?.unit,background:"color"===e?.background?.type?e?.background?.color:e?.background?.image,borderTop:`${e?.border?.top?.value||0}${e?.border?.unit||"px"} solid ${e?.border?.color}`,borderBottom:`${e?.border?.bottom?.value||0}${e?.border?.unit||"px"} solid ${e?.border?.color}`,borderRight:`${e?.border?.right?.value||0}${e?.border?.unit||"px"} solid ${e?.border?.color}`,borderLeft:`${e?.border?.left?.value||0}${e?.border?.unit||"px"} solid ${e?.border?.color}`,borderTopRightRadius:`${e?.border?.rounded?.topright?.value}${e?.border?.rounded?.unit}`,borderBottomRightRadius:`${e?.border?.rounded?.bottomright?.value}${e?.border?.rounded?.unit}`,borderBottomLeftRadius:`${e?.border?.rounded?.bottomleft?.value}${e?.border?.rounded?.unit}`,borderTopLeftRadius:`${e?.border?.rounded?.topleft?.value}${e?.border?.rounded?.unit}`};return o?.toRemove&&o.toRemove.forEach((e=>{delete t[e]})),t}fetchAnnouncementData();