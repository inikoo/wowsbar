function iframeStyle(e){e.id="iframe-wowsbar",e.setAttribute("allowTransparency","true"),e.style.height="0px",e.style.width="100%",e.style.display="block",e.style.backgroundColor="transparent",e.style.border="none",e.style.isolation="isolate",e.style.position="relative",e.style.zIndex=9999,e.style.transition="all 0.2s ease-in-out",e.frameBorder="0"}function setInnerHTML(e,o){e.replaceWith(o),Array.from(e.querySelectorAll("script")).forEach((e=>{const o=document.createElement("script");Array.from(e.attributes).forEach((e=>{o.setAttribute(e.name,e.value)}));const t=document.createTextNode(e.innerHTML);o.appendChild(t),e.parentNode.replaceChild(o,e)}))}async function fetchAnnouncementData(){const e=new URL(document.currentScript.src),o=e.searchParams.get("ulid"),t=e.searchParams.get("logged_in"),n=e.searchParams.get("json");console.log("ulid:",o,"jsonUrl:",n);let r=window.location.hostname;const i=window.location.pathname;console.log("domain:",r,"path:",i),r.startsWith("www.")&&(r=r.slice(4));try{console.log("> On try");const e=`${n}?domain=${r}${i}&logged_in=${t}`;console.log("inner_url:",e);const o=encodeURIComponent(e);console.log("inner_url_encoded:",o);const a=await fetch("ar_web_wowsbar_announcement.php",{headers:{Accept:"application/json","Content-Type":"application/json","X-Wowsbar-Announcement-Url":e}}).then((async e=>{if(console.log("> On response",e),!e.ok)throw new Error("Network response was not ok ---- "+e.statusText);return await e.json()}));if(console.log("======== new Announctment data",a),a?.compiled_layout){console.log("Compiled layout found",a.ulid);const e=document.querySelector("#wowsbar_announcement"),o=document.createElement("div");o.innerHTML=a.compiled_layout;o.querySelectorAll("script").forEach((e=>{const o=document.createElement("script");o.textContent=e.textContent,document.head.appendChild(o)})),e.replaceWith(...o.childNodes);const t={height:"50px",data:a.compiled_layout};localStorage.setItem("__wowsbar_announcement",JSON.stringify(t))}else console.log("No compiled layout found");window.addEventListener("message",(function(e){console.log("received message",e.data),"close_button_click"===e.data&&(console.log("Close button clicked"),iframe.style.top=`-${parseInt(containerStyle.height,10)+parseInt(containerStyle.height,10)}px`)}))}catch(e){console.error("Announcement went wrong:",e)}}function propertiesToHTMLStyle(e,o){const t={position:e.position?.type||"static",left:e.isCenterHorizontal&&"fixed"===e.position?.type?"50%":e.position?.x||"0px",top:e.position?.y||"0px",transform:e.isCenterHorizontal&&"fixed"===e.position?.type?"translateX(-50%)":"",height:(e?.dimension?.height?.value||0)+e?.dimension?.height?.unit||"px",width:(e?.dimension?.width?.value||0)+e?.dimension?.width?.unit||"px",color:e?.text?.color,fontFamily:e?.text?.fontFamily,paddingTop:(e?.padding?.top?.value||0)+e?.padding?.unit,paddingBottom:(e?.padding?.bottom?.value||0)+e?.padding?.unit,paddingRight:(e?.padding?.right?.value||0)+e?.padding?.unit,paddingLeft:(e?.padding?.left?.value||0)+e?.padding?.unit,marginTop:(e?.margin?.top?.value||0)+e?.margin?.unit,marginBottom:(e?.margin?.bottom?.value||0)+e?.margin?.unit,marginRight:e.isCenterHorizontal?"auto":(e?.margin?.right?.value||0)+e?.margin?.unit,marginLeft:e.isCenterHorizontal?"auto":(e?.margin?.left?.value||0)+e?.margin?.unit,background:"color"===e?.background?.type?e?.background?.color:e?.background?.image,borderTop:`${e?.border?.top?.value||0}${e?.border?.unit||"px"} solid ${e?.border?.color}`,borderBottom:`${e?.border?.bottom?.value||0}${e?.border?.unit||"px"} solid ${e?.border?.color}`,borderRight:`${e?.border?.right?.value||0}${e?.border?.unit||"px"} solid ${e?.border?.color}`,borderLeft:`${e?.border?.left?.value||0}${e?.border?.unit||"px"} solid ${e?.border?.color}`,borderTopRightRadius:`${e?.border?.rounded?.topright?.value}${e?.border?.rounded?.unit}`,borderBottomRightRadius:`${e?.border?.rounded?.bottomright?.value}${e?.border?.rounded?.unit}`,borderBottomLeftRadius:`${e?.border?.rounded?.bottomleft?.value}${e?.border?.rounded?.unit}`,borderTopLeftRadius:`${e?.border?.rounded?.topleft?.value}${e?.border?.rounded?.unit}`,boxSizing:"border-box"};return o?.toRemove&&o.toRemove.forEach((e=>{delete t[e]})),t}fetchAnnouncementData();